name: 4. Project Build ğŸ—ï¸

on:
  workflow_dispatch:
  # push:
  #   branches:
  #     - main
  #     - 'releases/**'

env:
  UNITY_LICENSE: ${{ secrets.UNITY_LICENSE }}
  repo: ${{ github.repository }}

jobs:
  Check-Unity-License:
    name: Check Unity License â˜‘ï¸
    uses: ./.github/workflows/check-unity-license.yml
    secrets: inherit

  Test-Runner:
    name: Test Runner ğŸ§ª
    uses: ./.github/workflows/test-runner.yml
    secrets: inherit

  Build-Release:
    name: Release Package ğŸ“¦
    needs: Test-Runner
    uses: ./.github/workflows/release.yml
    secrets: inherit

  Build-WebGL:
    name: Build WebGL ğŸ•¸
    needs: Test-Runner
    # UsuniÄ™to matrix.platform, poniewaÅ¼ ten job bÄ™dzie zawsze budowaÅ‚ WebGL
    uses: ./.github/workflows/deploy-to-webgl.yml
    secrets: inherit

  Build-Windows:
    name: Build Windows ğŸ–¥ï¸
    needs: Test-Runner
    # UsuniÄ™to matrix.platform, poniewaÅ¼ ten job bÄ™dzie zawsze budowaÅ‚ Windows
    uses: ./.github/workflows/deploy-to-windows64.yml
    secrets: inherit

  Build-Android:
    name: Build Android ğŸ“±
    needs: Test-Runner
    # UsuniÄ™to matrix.platform, poniewaÅ¼ ten job bÄ™dzie zawsze budowaÅ‚ Android
    uses: ./.github/workflows/deploy-to-android.yml
    secrets: inherit

  Publish-Github-Page:
    name: Publish Github Page ğŸš€
    # Zmieniono needs na konkretne joby, ktÃ³re produkujÄ… artefakty
    needs:
      - Build-WebGL # Zalozenie, ze strona bedzie budowana na podstawie WebGL
    if: ${{ needs.Build-WebGL.result == 'success' }}
    uses: ./.github/workflows/deploy-to-github-web.yml
    secrets: inherit

  # CaÅ‚a sekcja Send-Notifications zostaÅ‚a usuniÄ™ta, poniewaÅ¼ brakowaÅ‚o plikÃ³w powiadomieÅ„.
  # JeÅ›li w przyszÅ‚oÅ›ci zechcesz dodaÄ‡ powiadomienia, bÄ™dziesz musiaÅ‚ stworzyÄ‡
  # odpowiednie pliki (np. notify-discord.yml, notify-teams.yml) z on: workflow_call.
